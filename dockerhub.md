# Motion Vector Extractor

The [motion vector extractor](https://github.com/LukasBommes/mv-extractor) is a tool to extract frames, motion vectors, frame types and timestamps from H.264 and MPEG-4 Part 2 encoded videos. The tool provides a single class, which serves as a replacement for OpenCV's [VideoCapture](https://docs.opencv.org/4.1.0/d8/dfe/classcv_1_1VideoCapture.html) and can be used to read and decode video frames from a H.264 or MPEG-4 Part 2 encoded video stream/file.

This Docker image is based on the [manylinux_2_28](https://github.com/pypa/manylinux) image and serves two purposes:
1. It contains all dependencies to run the motion vector extractor and its test suite.
2. It functions as build environment for building the [Python package](https://pypi.org/project/motion-vector-extractor/) of the motion vector extraction for all supported Python versions.

## Tags with respective Dockerfile links

- [`v1.1.0`, `latest`](https://github.com/LukasBommes/mv-extractor/blob/c56b94b9ec7e96e273e67eb5cf19f0e6b927f68b/Dockerfile)
- [`v1.0.6`](https://github.com/LukasBommes/mv-extractor/blob/75424afe230f9847f3e86e243f46d3105eeba858/Dockerfile)
- [`v1.0.5`](https://github.com/LukasBommes/mv-extractor/blob/ac539243f6cd7cc1d9640d8ce52ba1814a3cbc7d/Dockerfile)
- [`v1.0.4`](https://github.com/LukasBommes/mv-extractor/blob/94a79e0ce72446beb7b3862f8ed04a1cbce0d1a3/Dockerfile)
- [`v1.0.3`](https://github.com/LukasBommes/mv-extractor/blob/2ccce5b85e1c9cf813271e443490981c5773dc02/Dockerfile)
- [`v1.0.2`](https://github.com/LukasBommes/mv-extractor/blob/4dc77fe5681d55820b43657c63c81294bf47a0bc/Dockerfile)
- [`v1.0.1`](https://github.com/LukasBommes/mv-extractor/blob/17ae26680194b49996e01397871bef857064514f/Dockerfile)
- [`v1.0.0`](https://github.com/LukasBommes/mv-extractor/blob/4b44302a44e78618aeabde95ee02cecee311b456/Dockerfile)

Images tagged with `dev` and `buildcache` are intermediate artefacts generated by the CI and should not be used directly.

## Usage

Pull and run the motion vector extractor with
```cmd
docker run lubo1994/mv-extractor:latest extract_mvs -h
```

Map a video file into the container and extract motion vectors (replace <videofile.mp4> with the actual filename)
```cmd
docker run -v ./<videofile.mp4>:/home/video_cap/<videofile.mp4> lubo1994/mv-extractor:latest extract_mvs <videofile.mp4> --verbose
```

If you want to use the graphical preview, you have to supply additional arguments to the docker run command
```cmd
docker run -it --ipc=host --env="DISPLAY" -v ./<videofile.mp4>:/home/video_cap/<videofile.mp4> -v /tmp/.X11-unix:/tmp/.X11-unix:rw lubo1994/mv-extractor:latest extract_mvs <videofile.mp4> --preview
```

For more details on the usage see the [project homepage](https://github.com/LukasBommes/mv-extractor).

## About

This software is written by **Dr.-Ing. Lukas Bommes** and licensed under the [MIT License](https://github.com/LukasBommes/mv-extractor/blob/master/LICENSE).

If you use the project for academic research please cite

```text
@INPROCEEDINGS{9248145,
  author={L. {Bommes} and X. {Lin} and J. {Zhou}},
  booktitle={2020 15th IEEE Conference on Industrial Electronics and Applications (ICIEA)}, 
  title={MVmed: Fast Multi-Object Tracking in the Compressed Domain}, 
  year={2020},
  volume={},
  number={},
  pages={1419-1424},
  doi={10.1109/ICIEA48937.2020.9248145}}
```
